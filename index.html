<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –Ω–æ—Ä–º —Ä–∞—Å—Ö–æ–¥–∞ —ç–ª–µ–∫—Ç—Ä–æ—ç–Ω–µ—Ä–≥–∏–∏ - –†–ñ–î</title>
    <meta name="description" content="–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –Ω–æ—Ä–º —Ä–∞—Å—Ö–æ–¥–∞ —ç–ª–µ–∫—Ç—Ä–æ—ç–Ω–µ—Ä–≥–∏–∏ –≤ –≥—Ä—É–∑–æ–≤–æ–º –¥–≤–∏–∂–µ–Ω–∏–∏ –Ω–∞ —Ç—è–≥—É –ø–æ–µ–∑–¥–æ–≤">
    <meta name="keywords" content="–†–ñ–î, –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä, —ç–ª–µ–∫—Ç—Ä–æ—ç–Ω–µ—Ä–≥–∏—è, –ª–æ–∫–æ–º–æ—Ç–∏–≤, –≥—Ä—É–∑–æ–≤–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ">
    <meta name="author" content="–†–ñ–î –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä">
    <meta name="theme-color" content="#007bff">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Icons -->
    <link rel="icon" type="image/svg+xml" href="icons/icon.svg">
    <link rel="apple-touch-icon" href="icons/icon.svg">
    
    <!-- iOS PWA Support -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="–†–ñ–î –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä">
    
    <!-- Android PWA Support -->
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/themes.css">
    <link rel="stylesheet" href="styles/components.css">
    <link rel="stylesheet" href="styles/pwa.css">
</head>
<body class="theme-light">
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <h1 class="header-title">
                    <span class="header-icon">üöÇ</span>
                    –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –Ω–æ—Ä–º —Ä–∞—Å—Ö–æ–¥–∞ —ç–ª–µ–∫—Ç—Ä–æ—ç–Ω–µ—Ä–≥–∏–∏
                </h1>
                <p class="header-subtitle">–†–∞—Å—á–µ—Ç —ç–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è –≤ –≥—Ä—É–∑–æ–≤–æ–º –¥–≤–∏–∂–µ–Ω–∏–∏</p>
                <button class="theme-toggle" id="themeToggle" aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">
                    <span class="theme-icon">üåô</span>
                </button>
            </div>
        </header>

        <!-- Main Calculator -->
        <main class="main">
            <div class="calculator-card">
                <!-- Route Selection -->
                <div class="form-section">
                    <h2 class="section-title">–ú–∞—Ä—à—Ä—É—Ç</h2>
                    <div class="input-group">
                        <label for="route">–í—ã–±–µ—Ä–∏—Ç–µ –º–∞—Ä—à—Ä—É—Ç</label>
                        <select id="route" name="route" required>
                            <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –º–∞—Ä—à—Ä—É—Ç --</option>
                        </select>
                    </div>
                    
                    <!-- Custom Route Input -->
                    
                    <!-- Route Information Display -->
                    <div class="route-info-display" id="routeInfoDisplay" style="display: none;">
                        <div class="route-info-card">
                            <h3 id="selectedRouteName">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–∞—Ä—à—Ä—É—Ç–µ</h3>
                            <p class="route-distance">–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ: <strong id="selectedRouteDistance">0 –∫–º</strong></p>
                            <p class="route-travel-time" style="display: none;">–í—Ä–µ–º—è –≤ –ø—É—Ç–∏: <strong id="selectedRouteTravelTime">0 —á</strong></p>

                            <button type="button" class="btn btn-secondary" id="showCoefficientsBtn">
                                <span class="btn-icon">üìã</span>
                                –û—Ç–∫—Ä—ã—Ç—å —Ç–∞–±–ª–∏—Ü—É –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤
                            </button>

                            <div class="coefficients-section" id="coefficientsSection" style="display: none;">
                                <h4>–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã —ç–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è</h4>
                                <div class="coefficients-table-container">
                                    <table class="coefficients-table" id="coefficientsTable">
                                        <thead>
                                            <tr>
                                                <th>–õ–æ–∫–æ–º–æ—Ç–∏–≤</th>
                                                <th>6</th>
                                                <th>7</th>
                                                <th>8</th>
                                                <th>9</th>
                                                <th>10</th>
                                                <th>11</th>
                                                <th>12</th>
                                                <th>13</th>
                                                <th>14</th>
                                                <th>15</th>
                                                <th>16</th>
                                                <th>17</th>
                                                <th>18</th>
                                                <th>19</th>
                                                <th>20</th>
                                                <th>21</th>
                                                <th>22</th>
                                                <th>23</th>
                                            </tr>
                                            <tr class="table-subheader">
                                                <th>–ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –æ—Å—å (—Ç/–æ—Å—å)</th>
                                                <th colspan="18">–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã</th>
                                            </tr>
                                        </thead>
                                        <tbody id="coefficientsTableBody">
                                            <!-- Coefficients will be populated here -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <div class="no-coefficients" id="noCoefficients" style="display: none;">
                                <p><em>–î–ª—è —ç—Ç–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –ª–æ–∫–æ–º–æ—Ç–∏–≤–æ–≤</em></p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Results Section -->
                <div class="results-section" id="resultsSection" style="display: none;">
                    <h2 class="section-title">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á–µ—Ç–∞</h2>
                    <div class="results-grid">
                        <div class="result-card">
                            <h3>–ù–æ—Ä–º–∞ —Ä–∞—Å—Ö–æ–¥–∞ –∑–∞ –ø–æ–µ–∑–¥–∫—É</h3>
                            <div class="result-value" id="consumptionResult">0 –∫–í—Ç‚ãÖ—á</div>
                        </div>
                        <div class="result-card">
                            <h3>–ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –æ—Å—å</h3>
                            <div class="result-value" id="axleLoadResult">0 —Ç/–æ—Å—å</div>
                        </div>
                        <div class="result-card" id="trainLengthCard" style="display: none;">
                            <h3>–î–ª–∏–Ω–∞ —Å–æ—Å—Ç–∞–≤–∞</h3>
                            <div class="result-value" id="trainLengthResult">0 –º</div>
                        </div>
                    </div>
                    
                    <!-- Export and Actions -->
                    <div class="result-actions">
                        <button type="button" class="btn btn-secondary" id="exportBtn">
                            <span class="btn-icon">üìä</span>
                            –≠–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
                        </button>
                        <button type="button" class="btn btn-secondary" id="saveToHistoryBtn">
                            <span class="btn-icon">üíæ</span>
                            –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –∏—Å—Ç–æ—Ä–∏—é
                        </button>
                        <button type="button" class="btn btn-secondary" id="showInfoBtn">
                            <span class="btn-icon">‚ÑπÔ∏è</span>
                            –°–ø—Ä–∞–≤–∫–∞
                        </button>
                    </div>
                </div>

                <form class="calculator-form" id="calculatorForm">
                    <!-- Locomotive Selection -->
                    <div class="form-section">
                        <h2 class="section-title">–í—ã–±–æ—Ä –ª–æ–∫–æ–º–æ—Ç–∏–≤–æ–≤</h2>
                        <div class="locomotive-controls">
                            <button type="button" class="btn btn-secondary" id="addLocomotiveBtn">+–õ</button>
                            <button type="button" class="btn btn-secondary" id="addColdLocomotiveBtn">+–•</button>
                        </div>
                        <div class="locomotive-container" id="locomotiveContainer">
                            <div class="locomotive-card-wrapper" id="locomotiveCard1">
                                <div class="locomotive-card locomotive-vl10u" onclick="toggleLocomotiveSelection(1)">
                                    <div class="locomotive-info">
                                        <h3>–í–õ10–£</h3>
                                        <p>–î–ª–∏–Ω–∞: 32–º</p>
                                    </div>
                                </div>
                                <div class="locomotive-type-selector" id="locomotiveSelector1" style="display:none;">
                                    <div class="locomotive-option" onclick="selectLocomotiveType(1, 'vl10', '–í–õ10', 32)">
                                        <div class="locomotive-card locomotive-vl10">
                                            <div class="locomotive-info">
                                                <h3>–í–õ10</h3>
                                                <p>–î–ª–∏–Ω–∞: 32–º</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="locomotive-option" onclick="selectLocomotiveType(1, 'vl10u', '–í–õ10–£', 32)">
                                        <div class="locomotive-card locomotive-vl10u">
                                            <div class="locomotive-info">
                                                <h3>–í–õ10–£</h3>
                                                <p>–î–ª–∏–Ω–∞: 32–º</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="locomotive-option" onclick="selectLocomotiveType(1, '2es6', '2–≠–°6', 34)">
                                        <div class="locomotive-card locomotive-es6">
                                            <div class="locomotive-info">
                                                <h3>2–≠–°6</h3>
                                                <p>–î–ª–∏–Ω–∞: 34–º</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="locomotive-option" onclick="selectLocomotiveType(1, 'vl10k', '–í–õ10–ö', 30)">
                                        <div class="locomotive-card locomotive-vl10k">
                                            <div class="locomotive-info">
                                                <h3>–í–õ10–ö</h3>
                                                <p>–î–ª–∏–Ω–∞: 30–º</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="locomotive-option" onclick="selectLocomotiveType(1, 'vl10uk', '–í–õ10–£–ö', 32)">
                                        <div class="locomotive-card locomotive-vl10uk">
                                            <div class="locomotive-info">
                                                <h3>–í–õ10–£–ö</h3>
                                                <p>–î–ª–∏–Ω–∞: 32–º</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <button class="remove-locomotive-btn" onclick="removeLocomotive(1)">√ó</button>
                            </div>
                        </div>
                    </div>

                    <!-- Train Parameters -->
                    <div class="form-section">
                        <h2 class="section-title">–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–µ–∑–¥–∞</h2>
                        <div class="train-params-card">
                            <div class="input-group">
                                <label for="trainWeight">–í–µ—Å (—Ç–æ–Ω–Ω)</label>
                                <input type="number" class="compact-input" id="trainWeight" name="trainWeight" min="100" max="10000" step="1" required>
                            </div>
                            <div class="input-group">
                                <label for="trainAxles">–û—Å–∏</label>
                                <input type="number" class="compact-input" id="trainAxles" name="trainAxles" min="10" max="500" step="1" required>
                            </div>
                            <div class="input-group">
                                <label for="actualWagons">–§–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –≤–∞–≥–æ–Ω—ã</label>
                                <input type="number" class="compact-input" id="actualWagons" name="actualWagons" min="0" max="1000" step="1">
                            </div>
                            <div class="input-group">
                                <label for="conditionalWagons">–£—Å–ª–æ–≤–Ω—ã–µ –≤–∞–≥–æ–Ω—ã</label>
                                <input type="number" class="compact-input" id="conditionalWagons" name="conditionalWagons" min="0" max="1000" step="1">
                            </div>
                        </div>
                    </div>

                </form>

                <!-- History Section -->
                <div class="history-section" id="historySection" style="display: none;">
                    <h2 class="section-title">–ò—Å—Ç–æ—Ä–∏—è —Ä–∞—Å—á–µ—Ç–æ–≤</h2>
                    <div id="historyList" class="history-list"></div>
                    <div class="history-actions">
                        <button type="button" class="btn btn-secondary" id="clearHistoryBtn">
                            <span class="btn-icon">üóëÔ∏è</span>
                            –û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é
                        </button>
                    </div>
                </div>

                <!-- Info Modal -->
                <div class="modal" id="infoModal" style="display: none;">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2>–°–ø—Ä–∞–≤–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
                            <button class="modal-close" id="closeModalBtn">&times;</button>
                        </div>
                        <div class="modal-body">
                            <h3>–õ–æ–∫–æ–º–æ—Ç–∏–≤—ã</h3>
                            <div class="info-grid">
                                <div class="info-card">
                                    <h4>–í–õ10–£</h4>
                                    <p><strong>–î–ª–∏–Ω–∞:</strong> 32 –º</p>
                                </div>
                                <div class="info-card">
                                    <h4>2–≠–°6</h4>
                                    <p><strong>–î–ª–∏–Ω–∞:</strong> 34 –º</p>
                                </div>
                                <div class="info-card">
                                    <h4>–í–õ10–ö</h4>
                                    <p><strong>–î–ª–∏–Ω–∞:</strong> 30 –º</p>
                                </div>
                                <div class="info-card">
                                    <h4>–í–õ10–£–ö</h4>
                                    <p><strong>–î–ª–∏–Ω–∞:</strong> 32 –º</p>
                                </div>
                            </div>
                            
                            <h3>–§–æ—Ä–º—É–ª–∞ —Ä–∞—Å—á–µ—Ç–∞</h3>
                            <div class="formula-card">
                                <code>–ù–æ—Ä–º–∞ = (–í–µ—Å √ó –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç √ó –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ) / 10000 / 100</code>
                                <p>–≥–¥–µ:</p>
                                <ul>
                                    <li><strong>–í–µ—Å</strong> - –≤–µ—Å –ø–æ–µ–∑–¥–∞ –≤ —Ç–æ–Ω–Ω–∞—Ö</li>
                                    <li><strong>–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç</strong> - –±–µ—Ä–µ—Ç—Å—è –∏–∑ –¥–∞–Ω–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –ª–æ–∫–æ–º–æ—Ç–∏–≤–∞ –∏ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –æ—Å—å (–æ–∫—Ä—É–≥–ª–µ–Ω–Ω–æ–π –¥–æ —Ü–µ–ª–æ–≥–æ —á–∏—Å–ª–∞)</li>
                                    <li><strong>–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ</strong> - —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–∞ –≤ –∫–º</li>
                                </ul>
                                <p><strong>–ü—Ä–∏–º–µ—Ä —Ä–∞—Å—á–µ—Ç–∞:</strong></p>
                                <p>–í–µ—Å: 1191—Ç, –û—Å–∏: 120, –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –æ—Å—å: 1191√∑120=9.925‚Üí10—Ç/–æ—Å—å</p>
                                <p>–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –í–õ10–£ –¥–ª—è 10—Ç/–æ—Å—å –Ω–∞ –º–∞—Ä—à—Ä—É—Ç–µ "–ê–±–¥—É–ª–∏–Ω–æ-–ö–∏–Ω–µ–ª—å": 72.45</p>
                                <p>–ù–æ—Ä–º–∞: 72.45√ó1191√ó233√∑10000√∑100 = 20.11 –∫–í—Ç‚ãÖ—á</p>
                            </div>
                            
                            <h3>–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö</h3>
                            <div class="info-card">
                                <p><strong>–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã —ç–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è</strong> –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ —Ñ–∞–π–ª–æ–≤ –º–∞—Ä—à—Ä—É—Ç–æ–≤ –≤ –ø–∞–ø–∫–µ /data</p>
                                <p><strong>–î–ª–∏–Ω–∞ –≤–∞–≥–æ–Ω–∞:</strong> 14 –º (–¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –¥–ª–∏–Ω—ã —Å–æ—Å—Ç–∞–≤–∞)</p>
                                <p><strong>–ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –æ—Å—å</strong> —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ –≤–µ—Å –ø–æ–µ–∑–¥–∞, –¥–µ–ª–µ–Ω–Ω—ã–π –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Å–µ–π, –∏ –æ–∫—Ä—É–≥–ª—è–µ—Ç—Å—è –¥–æ –±–ª–∏–∂–∞–π—à–µ–≥–æ —Ü–µ–ª–æ–≥–æ —á–∏—Å–ª–∞</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <p>&copy; 2024 –†–ñ–î –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —ç–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è</p>
        </footer>
    </div>

    <script src="scripts/data.js"></script>
    <script src="scripts/calculator.js"></script>
    <script src="scripts/themes.js"></script>
    <script src="scripts/pwa.js"></script>
    
    <!-- PWA Service Worker Registration -->
    <script>
        // Register service worker for PWA functionality
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then((registration) => {
                        console.log('SW registered: ', registration);
                    })
                    .catch((registrationError) => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
        
        // PWA Install Prompt
        let deferredPrompt;
        
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // Create install button
            const installButton = document.createElement('button');
            installButton.className = 'btn btn-secondary';
            installButton.innerHTML = '<span class="btn-icon">üì±</span> –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ';
            installButton.style.cssText = 'position: fixed; bottom: 20px; right: 20px; z-index: 1000; box-shadow: 0 4px 16px rgba(0,0,0,0.2);';
            
            installButton.addEventListener('click', async () => {
                if (deferredPrompt) {
                    deferredPrompt.prompt();
                    const { outcome } = await deferredPrompt.userChoice;
                    console.log(`Install prompt result: ${outcome}`);
                    deferredPrompt = null;
                    installButton.remove();
                }
            });
            
            document.body.appendChild(installButton);
        });
    </script>

</body>
</html>