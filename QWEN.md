# Калькулятор норм расхода электроэнергии РЖД

## Обзор проекта

Это прогрессивное веб-приложение (PWA) для расчета норм расхода электроэнергии в грузовом движении на тягу поездов на железной дороге. Приложение позволяет пользователям выбирать тип локомотива, вводить параметры поезда и выбирать маршрут для точного расчета энергопотребления.

### Основные особенности

- **Динамическая загрузка маршрутов** - Автоматическое обнаружение и загрузка всех .md файлов из папки `/data`
- **Точные расчеты** - Использует индивидуальные коэффициенты для каждого маршрута или стандартные значения для локомотивов ВЛ10У и 2ЭС6
- **Современный интерфейс** - Адаптивный дизайн с поддержкой светлой и тёмной тем
- **Мобильная версия** - Работает на всех устройствах
- **PWA (Прогрессивное веб-приложение)** - Можно установить как приложение, работает офлайн
- **Пользовательские маршруты** - Возможность добавления собственных маршрутов с коэффициентами
- **История расчетов** - Сохранение последних 10 расчетов в браузере
- **Экспорт данных** - Сохранение результатов в текстовый файл
- **Справочная информация** - Подробные данные о локомотивах и формулах

## Архитектура проекта

```
zimixin.github.io/
├── index.html              # Главная страница приложения
├── manifest.json           # PWA манифест
├── sw.js                   # Service Worker для PWA
├── styles/
│   ├── main.css            # Основные стили и компоненты
│   ├── themes.css          # Темы (светлая/тёмная)
│   ├── components.css      # Стили компонентов UI
│   └── pwa.css             # Стили для PWA функций
├── scripts/
│   ├── data.js             # Данные локомотивов, загрузка маршрутов
│   ├── calculator.js       # Основная логика калькулятора
│   ├── themes.js           # Управление темами
│   └── pwa.js              # Функции PWA
├── icons/                  # Иконки для PWA
├── data/                   # Файлы маршрутов (Markdown)
│   ├── abdulino-kinel.md
│   ├── abdulino-oktyabrsk.md
│   ├── abdulino-syzran.md
│   ├── kinel-abdulino.md
│   ├── moscow-spb.md
│   └── syzran-abdulino.md
├── offline.html            # Страница для офлайн режима
├── README.md               # Документация проекта
└── QWEN.md                 # Текущий файл документации
```

## Технологии

- **HTML5** - Семантическая разметка с accessibility поддержкой
- **CSS3** - Современные стили с CSS Custom Properties, Grid и Flexbox
- **Vanilla JavaScript** - Без внешних зависимостей, ES6+ синтаксис
- **Service Worker** - Офлайн работа и кэширование PWA
- **Web App Manifest** - Метаданные для установки PWA
- **LocalStorage** - Сохранение настроек, истории и пользовательских маршрутов
- **Fetch API** - Динамическая загрузка маршрутов
- **Progressive Web App** готовое приложение

## Формула расчета

```
Норма расхода = (Вес поезда × Коэффициент × Расстояние) / 10000 / 100
```

Где:
- **Вес поезда** - масса состава в тоннах
- **Коэффициент** - зависит от типа локомотива и нагрузки на ось (индивидуальный для маршрута или стандартный)
- **Расстояние** - длина маршрута в километрах

## Поддерживаемые локомотивы

### ВЛ10У
- Длина: 32 м
- Стандартные коэффициенты: 89.5 - 65.15
- Нагрузка на ось: 6-14+ т/ось

### 2ЭС6
- Длина: 34 м
- Стандартные коэффициенты: 82.0 - 59.73
- Нагрузка на ось: 6-14+ т/ось

## Формат файлов маршрутов

Маршруты определяются в Markdown файлах в папке `/data` со следующим форматом:

```
# Название маршрута
## Расстояние км

| нагрузка на ось | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 | 14 |
|-----------------|---|---|---|---|----|----|----|----|----|
| ВЛ10У | 89.5 | 83.41 | 78.85 | 75.29 | 72.45 | 70.13 | 68.19 | 66.55 | 65.15 |
| 2ЭС6 | 82.0 | 76.43 | 72.26 | 69.01 | 66.41 | 64.29 | 62.52 | 61.02 | 59.73 |
```

## Основные компоненты

1. **EnergyCalculator** (calculator.js) - Главный класс управления калькулятором
2. **ThemeManager** (themes.js) - Управление темами оформления
3. **Route Data Loader** (data.js) - Динамическая загрузка маршрутов
4. **PWAManager** (pwa.js) - Управление функциями PWA

## Поток данных

1. При загрузке страницы запускается автоматическое обнаружение файлов в `/data`
2. Каждый .md файл парсится и добавляется в ROUTE_DATA
3. Dropdown маршрутов обновляется доступными опциями
4. При расчете используются индивидуальные коэффициенты маршрута или стандартные значения

## Запуск и развертывание

### GitHub Pages
Проект автоматически развертывается на GitHub Pages при пуше в основную ветку.

### Локальный запуск

1. Клонируйте репозиторий:
```bash
git clone https://github.com/zimixin/zimixin.github.io.git
cd zimixin.github.io
```

2. Запустите локальный веб-сервер:
```bash
# Python 3
python -m http.server 8000

# Python 2
python -m SimpleHTTPServer 8000

# Node.js (если установлен)
npx serve .
```

3. Откройте http://localhost:8000 в браузере

Никаких дополнительных зависимостей не требуется - проект использует только HTML5, CSS3 и Vanilla JavaScript.

## Совместимость

- ✅ Chrome 70+ (PWA поддержка)
- ✅ Firefox 65+
- ✅ Safari 12+ (iOS PWA поддержка)
- ✅ Edge 79+ (PWA поддержка)
- ✅ Мобильные браузеры (iOS Safari, Chrome Mobile, Samsung Internet)

## Стандарты кода

- Используйте ES6+ синтаксис
- Комментируйте сложную логику
- Следуйте существующему стилю кода
- Тестируйте изменения в разных браузерах

## Функции PWA

- **Офлайн работа** - Полная функциональность без интернета
- **Установка на устройство** - Как обычное приложение
- **Быстрая загрузка** - Кэширование ресурсов
- **Полноэкранный режим** - Без адресной строки браузера
- **Оптимизация для мобильных** - Поддержка жестов и ориентации